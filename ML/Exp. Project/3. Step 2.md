Great. The fact that you found **937 duplicates** is a key insight. If we leave them in, our model might "memorize" these rows, leading to a higher accuracy score that isn't real (because the same data points could end up in both the training and testing sets).

According to the syllabus ("detects data quality issues... duplicates"), we must handle this now.

Here is **Step 2: Data Cleaning & Exploratory Data Analysis (EDA)**.

---

#### **Cell 4 [Markdown]: Data Cleaning**
```markdown
## 2. Data Cleaning
**Issue Identified:** We found 937 duplicate rows.
**Action:** We will remove these duplicates to prevent data leakage (where the same sample appears in both training and testing sets) and to ensure our model generalizes well.
```

#### **Cell 5 [Code]: Removing Duplicates**
```python
# Remove duplicates
df_cleaned = df.drop_duplicates()

print(f"Original shape: {df.shape}")
print(f"Shape after removing duplicates: {df_cleaned.shape}")
print(f"Rows dropped: {df.shape[0] - df_cleaned.shape[0]}")

# We will use df_cleaned for the rest of the analysis
df = df_cleaned.copy()
```

---

#### **Cell 6 [Markdown]: Exploratory Data Analysis (EDA)**
```markdown
## 3. Exploratory Data Analysis (EDA)
We need to understand the distribution of our target variable (`quality`) and the relationships between our features.

**Goals:**
1. Check if the dataset is balanced (Target Analysis).
2. Identify which features are most correlated with Quality (Correlation Analysis).
3. Detect outliers in the physicochemical properties (Feature Analysis).
```

#### **Cell 7 [Code]: Target Variable Analysis**
This plot is crucial. It will likely show that most wines are "average" (score 6), which makes this a hard problem for standard classifiers.

```python
def plot_target_distribution(data, column):
    """
    Plots the distribution of the target variable using a countplot.
    """
    plt.figure(figsize=(8, 5))
    sns.countplot(x=column, data=data, palette='viridis')
    plt.title(f'Distribution of Wine {column.capitalize()}', fontsize=15)
    plt.xlabel('Quality Score')
    plt.ylabel('Count')
    plt.show()

plot_target_distribution(df, 'quality')

# Print actual counts to quantify the imbalance
print(df['quality'].value_counts().sort_index())
```

#### **Cell 8 [Code]: Correlation Analysis**
We want to see "physicochemical" relationships. For example, **Density** is usually physically related to **Alcohol** and **Sugar**. Also, we want to know what drives **Quality**.

```python
def plot_correlation_matrix(data):
    """
    Computes and plots the correlation matrix heatmap.
    """
    plt.figure(figsize=(12, 10))
    
    # Calculate correlation
    corr = data.corr()
    
    # Plot heatmap
    sns.heatmap(corr, annot=True, fmt=".2f", cmap='coolwarm', vmin=-1, vmax=1, linewidths=0.5)
    plt.title('Correlation Matrix of Physicochemical Features', fontsize=15)
    plt.show()

plot_correlation_matrix(df)
```

#### **Cell 9 [Code]: Feature Distributions & Outliers**
The syllabus asks to look for **outliers**. Boxplots are the best tool for this. We will look specifically at `residual sugar` and `free sulfur dioxide` as they often vary wildly in wines.

```python
def plot_feature_boxplots(data, features):
    """
    Plots boxplots for selected features to identify outliers.
    """
    plt.figure(figsize=(15, 10))
    for i, col in enumerate(features):
        plt.subplot(3, 4, i + 1)
        sns.boxplot(y=data[col], color='skyblue')
        plt.title(col)
        plt.tight_layout()
    plt.show()

# Select all feature columns (excluding quality)
feature_cols = df.columns.drop('quality')
plot_feature_boxplots(df, feature_cols)
```

---

### **Action Required**
Run these cells. We are looking for two specific things to write in the "Analysis" part of your notebook:
1.  **Imbalance:** Does the `quality` plot show a "Normal Distribution" (bell curve) centered on 5 or 6? Are there very few 3s and 9s? (This justifies why we might group classes later).
2.  **Correlations:** Look at the `quality` row in the heatmap. Which variable has the highest **positive** number (closest to 1) and which has the highest **negative** number (closest to -1)?
    *   *Hypothesis:* Alcohol is usually positive. Density is usually negative.

**Let me know the results of the Correlation Heatmap (specifically what correlates with `quality`) and I will prepare Step 3: Feature Engineering.**