
---

# 14.5.1: ACL Configuration Guidelines

#### Fundamental Rules & Logic
*   **Top-Down Processing:** ACLs are read sequentially from the top down. As soon as a packet matches a rule, the `permit` or `deny` action is taken, and **no further rules are checked**.
*   **Implicit Deny:** Every ACL ends with an invisible `deny any` statement. If a packet doesn't match any of your `permit` rules, it will be dropped.
*   **One ACL per Interface/Protocol/Direction:** You can only apply one ACL per protocol (e.g., IPv4) and per direction (in/out) on a single interface.
    *   *Example:* On `GigabitEthernet0/0`, you can have one `ip access-group in` and one `ip access-group out`.
*   **Router-Generated Packets:** Traffic originating *from the router itself* (like pings or routing updates) is not filtered by outbound ACLs applied to its interfaces.

#### Rule Ordering Strategy
*   **Specific to General:** Always place your most specific rules at the top of the ACL and the most general rules at the bottom.
    *   **Correct:** `deny host 192.168.10.10` (specific) followed by `permit 192.168.10.0 0.0.0.255` (general).
    *   **Incorrect:** If you permit the whole subnet first, the specific deny rule will never be checked.

#### ACL Placement Strategy
This is a critical concept for network efficiency and security.

| ACL Type   | Best Placement         | Reason                                                                                                 |
| :--------- | :--------------------- | :----------------------------------------------------------------------------------------------------- |
| **Standard** | As close to the **Destination** as possible. | Because they only filter by **source**, placing them near the source could accidentally block that source from reaching other valid destinations. |
| **Extended** | As close to the **Source** as possible.      | Because they are very specific (source, destination, port), you can drop unwanted traffic immediately, saving bandwidth across your network. |


---

# 14.5.2: How to Apply an ACL

There are two primary places to apply an ACL: on a network interface to filter transit traffic, or on VTY lines to protect management access to the router itself.

#### Core Application Commands

| Context | Command | Purpose |
| :--- | :--- | :--- |
| **On an Interface** `(config-if)#` | `ip access-group {name | #} {in | out}` | Filters packets passing **through** the router. |
| **On VTY Lines** `(config-line)#` | `access-class {name | #} {in | out}` | Filters remote access (Telnet/SSH) **to** the router. |

---
### Use Case Examples

#### 1. Standard ACL on an Interface
*   **Goal:** Block a specific host (`192.168.11.10`) from accessing a network (`192.168.10.0/24`).
*   **ACL (`NO_ACCESS`):**
    1.  `deny host 192.168.11.10` (Specific rule first)
    2.  `permit any` (General rule to allow all other traffic)
*   **Application:** Applied **`out`** on the destination network's interface (`g0/0`) because standard ACLs should be placed close to the destination.

#### 2. Extended ACLs on an Interface (In & Out)
*   **Goal:** Allow internal users to browse the web but block all new incoming connections.
*   **ACL `SURFING` (applied `in`):** Permits outgoing HTTP/HTTPS traffic from the internal LAN.
*   **ACL `BROWSING` (applied `out`):** Permits only `established` return traffic back into the LAN.
*   **Application:** Both ACLs are applied to the same internal interface (`g0/0`), demonstrating the "one ACL per protocol per direction" rule.

#### 3. ACL on VTY Lines with Logging
*   **Goal:** Restrict management access (Telnet/SSH) to only a specific admin PC (`192.168.10.10`).
*   **ACL (`VTY_ACCESS`):**
    1.  `permit 192.168.10.10 log`
    2.  `deny any`
*   **Application:** Applied **`in`** to the `line vty 0 4` using the `access-class` command.
*   **The `log` Keyword:**
    *   **Function:** Generates a system log message whenever a packet matches that specific rule.
    *   **Warning:** This is **highly CPU-intensive** and can severely degrade router performance. Only use it for temporary troubleshooting or active security investigations.

---
### Removing an ACL (Two-Step Process)
1.  **Un-apply from the Interface:** Go to the interface and use the `no ip access-group ...` command. This stops the ACL from filtering traffic, but the ACL still exists in the router's configuration.
2.  **Delete from the Router:** In global config mode, use the `no access-list ...` command to permanently remove the ACL definition.


---

# 14.5.3: Where to Place ACLs

Proper ACL placement is crucial for network efficiency and security. The decision is based on several factors, leading to two primary rules for standard vs. extended ACLs.

#### Factors Influencing Placement

| Factor                          | Explanation                                                                                                                                                                                             |
| :------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Organizational Control**      | Placement depends on whether you have administrative control over the source and/or destination networks.                                                                                                 |
| **Bandwidth**                   | To save bandwidth on transit links, it's best to filter unwanted traffic as early as possible (at the source).                                                                                             |
| **Ease of Configuration**       | **Trade-off:** <br>• Placing an ACL at the destination might be simpler (one ACL). <br>• But it wastes bandwidth. <br>• Placing extended ACLs at the source is more efficient but may require configuring ACLs on multiple routers. |

---

### General Placement Rules (Standard vs. Extended)

The capabilities of each ACL type dictate the best practice for its placement.

| ACL Type   | Best Placement                       | Reasoning                                                                                                                                                                                                                                                        |
| :--------- | :----------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Extended** | As close to the **Source** as possible. | **Why:** Extended ACLs are highly specific (source, destination, protocol, port). They can drop unwanted traffic immediately, preventing it from consuming bandwidth across the network. <br> *Example: Place on R1 to filter traffic from 192.168.10.0/24.* |
| **Standard** | As close to the **Destination** as possible. | **Why:** Standard ACLs only filter by source address. If you place one near the source, you might accidentally block that traffic from reaching *other valid destinations*. Placing it near the destination ensures it only affects traffic going to that specific network. <br> *Example: Place on R3 to protect 192.168.30.0/24.* |


---

# 14.5.4: Standard ACL Placement Example

#### Objective
To prevent traffic from the `192.168.10.0/24` network from reaching the `192.168.30.0/24` network, while still allowing it to reach other networks (like `192.168.31.0/24`).

#### Standard ACL Placement Rule
*   Standard ACLs should be placed **as close to the destination as possible**.
*   **Reason:** Because they only filter by **source IP address**, placing them too close to the source would unintentionally block that source from reaching *other legitimate destinations*.

---

#### Analysis of Placement Options on R3 (The Destination Router)

1.  **Option: `R3 S0/1/1` interface (Inbound)**
    *   **Result:** This would filter traffic from the `192.168.10.0/24` network as soon as it *enters* router R3.
    *   **Problem:** This is a **poor choice**. It would block traffic from the `.10` network to **all** destinations reachable via R3, including both the `192.168.30.0/24` network and the `192.168.31.0/24` network. The filtering is too broad.

2.  **Option: `R3 G0/0/0` interface (Outbound) - **BEST CHOICE****
    *   **Result:** This filters traffic only after it has been routed inside R3 and is about to **exit** towards the `192.168.30.0/24` network.
    *   **Benefit:** This is the **correct choice**. It specifically targets traffic destined *only* for the `192.168.30.0/24` network. Traffic from the `.10` network can still be routed and reach the `192.168.31.0/24` network through interface `G0/0/1`.

---
#### Conclusion
For a standard ACL, applying it **outbound** on the interface leading to the specific target network provides the most precise filtering, achieving the objective without causing unintended side effects.


---

# 14.5.7: Extended ACL Placement Example

#### Objective
To block specific traffic (FTP and Telnet) from `192.168.11.0/24` (Company A) to `192.168.30.0/24` (Company B), while permitting all other traffic.

#### Extended ACL Placement Rule
*   Place Extended ACLs as close to the **Source** as possible.
*   **Reason:** To filter unwanted traffic early, saving bandwidth and router processing power across the entire network.
*   **Constraint:** You can only place ACLs on devices you **control**.

---

#### Analysis of Placement Options

1.  **On R3 (Destination Router):**
    *   **Result:** This would work, but it's a **poor choice**.
    *   **Problem:** It allows the unwanted FTP/Telnet traffic to travel across the entire network (R1 -> R2 -> R3) just to be dropped at the end. This wastes bandwidth. Also, Company A does not control R3.

2.  **On R1 (Source Router) - S0/1/0 (Outbound):**
    *   **Result:** Filters traffic as it *exits* R1 towards the WAN.
    *   **Problem:** This is **inefficient**. The ACL would have to process traffic from *both* of R1's LANs (`192.168.10.0/24` and `192.168.11.0/24`), even though the rule only applies to traffic from one of them.

3.  **On R1 (Source Router) - G0/0/1 (Inbound) - **BEST CHOICE****:
    *   **Result:** Filters traffic as it *enters* R1 from the specific source network (`192.168.11.0/24`).
    *   **Benefit:** This is the **most efficient** solution. It stops the unwanted traffic at the earliest possible point and only processes packets from the relevant network, saving R1 from having to check packets from the `.10` network against this ACL.

---
#### Summary of Decision

| Placement Option        | Result                                              | Verdict          |
| :---------------------- | :-------------------------------------------------- | :--------------- |
| R3 (Destination)        | Wastes bandwidth; not controlled by the organization. | Poor Choice      |
| R1 `S0/1/0` (Outbound)  | Works, but inefficiently processes irrelevant traffic.  | Not Optimal      |
| **R1 `G0/0/1` (Inbound)** | **Filters only relevant traffic at the source.**    | **Best Choice**  |
