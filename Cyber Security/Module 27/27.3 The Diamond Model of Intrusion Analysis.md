# ðŸ’Ž The Diamond Model of Intrusion Analysis

## **1. Overview**
A model that represents a security incident as an **Event**.
*   **Event:** A time-bound activity restricted to a specific step where an adversary uses a capability over infrastructure to attack a victim.

## **2. The 4 Core Features (The Corners)**
The relationships between these 4 points define the intrusion.

| Feature | Definition | Relationship |
| :--- | :--- | :--- |
| **ðŸ§› Adversary** | The party responsible for the intrusion. | Uses **Infrastructure** & Develops **Capability**. |
| **ðŸ› ï¸ Capability** | The tool or technique used (e.g., Malware). | Used to exploit the **Victim**. |
| **ðŸŒ Infrastructure**| The network path used (e.g., Email, IPs, Domains). | Connects to the **Victim**. |
| **ðŸŽ¯ Victim** | The target of the attack. | Exploited by the **Capability**. |

> **Interpretation:** "The **Adversary** uses the **Infrastructure** to connect to the **Victim**. The Adversary develops **Capability** to exploit the **Victim**."

---

## **3. Meta-Features**
Additional elements that expand the model context.

| Meta-Feature | Description |
| :--- | :--- |
| **â° Timestamp** | Start and stop time of the event. |
| **phases** | The step in the Cyber Kill Chain (e.g., Recon, Delivery). |
| **ðŸ† Result** | What the adversary gained (Confidentiality, Integrity, Availability compromised). |
| **âž¡ï¸ Direction** | Path of the event (e.g., Adversary $\to$ Infrastructure, Victim $\to$ Infrastructure). |
| **ðŸ“ Methodology** | General type of event (e.g., Phishing, Port Scan, DDoS). |
| **ðŸ“¦ Resources** | External resources used (Software, Funds, Hardware, Knowledge). |

---

## **4. Pivoting (Connecting the Dots)**
The Diamond Model is ideal for illustrating how an analyst **pivots** from one piece of evidence to the next to uncover the full attack.

> [!example] **Example Scenario: Pivoting**
> 1.  **Victim $\to$ Capability:** Victim discovers malware.
> 2.  **Capability $\to$ Infrastructure:** Malware analysis reveals a CnC Domain.
> 3.  **Infrastructure Analysis:** CnC Domain resolves to a specific IP.
> 4.  **Infrastructure $\to$ Victim:** Firewall logs show *other* victims contacting that IP.
> 5.  **Infrastructure $\to$ Adversary:** IP ownership details reveal the attacker.

---

## **5. Activity Threads & The Kill Chain**
Adversaries don't stop at one event. Events are threaded together (Thread 1, Thread 2, etc.) and can be mapped vertically against the **Cyber Kill Chain**.

*   **Vertical Correlation:** Tracing the adversary's progress through the Kill Chain (Recon $\to$ Weaponization $\to$ Delivery...).
*   **Horizontal Correlation:** Tracing the adversary moving from **Victim 1** to **Victim 2** (Lateral Movement).

> **Scenario:** An adversary compromises **Victim 1**, turns their machine into a **proxy/bot**, and uses it to launch a new attack (Thread 2) against **Victim 2**. The victim *becomes* the infrastructure for the next attack.