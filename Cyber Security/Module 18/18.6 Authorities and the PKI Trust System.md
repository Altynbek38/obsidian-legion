
---

# 18.6.1: Public Key Management

#### The Problem of Trust
When two parties exchange public keys, how can they be sure the key truly belongs to the person or entity they claim to be? An attacker could intercept the exchange and substitute their own public key in a man-in-the-middle attack.

#### The Solution: A Trusted Third Party
The solution is to use a **trusted third party** to vouch for the identity associated with a public key.

*   **Analogy: The Driver's License**
    *   You prove your identity to a trusted government agency (the DMV).
    *   The DMV issues you an official, hard-to-forge ID card (your license).
    *   When you need to prove your identity (e.g., at a bank), the bank trusts the license because they trust the government that issued it.

---
#### Public Key Infrastructure (PKI)
*   **PKI** is the entire framework of policies, standards, and systems used to create, manage, distribute, and revoke digital certificates.
*   **Certificate Authority (CA):** The central component of PKI. A CA is a trusted organization (like the DMV in the analogy) that is responsible for:
    1.  Vetting and verifying the identity of an entity (a person, a website, etc.).
    2.  Issuing a **digital certificate** that binds that identity to a specific public key.

#### How it Works in Practice (HTTPS/SSL)
1.  A website owner proves their identity and domain ownership to a CA.
2.  The CA issues an **SSL certificate** for that website, which contains the website's public key and is digitally signed by the CA.
3.  When you visit the website, your web browser receives this certificate.
4.  Your browser checks the CA's signature on the certificate. Because your browser's operating system has a pre-installed list of trusted CAs, it can verify the signature and trust that the certificate is legitimate.
5.  Your browser now has the website's authentic public key and can proceed with establishing a secure connection.

*   **Examples of CAs:** DigiCert, GlobalSign, Sectigo, Let's Encrypt (a non-profit CA).


---

# 18.6.2: The Public Key Infrastructure (PKI)

#### Core Concept
**PKI** is the complete system (hardware, software, policies, people) used to manage the lifecycle of digital certificates, enabling scalable, trusted communication.

---
#### Main Elements of PKI

| Component                       | Role / Purpose                                                                                                                                |
| :------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------- |
| **Digital Certificate**         | The electronic document that binds an identity to a public key. Contains the public key, owner's info, issuing CA, validity dates, etc.       |
| **Certificate Store**           | The location on a local computer where trusted CA certificates, issued certificates, and private keys are stored.                             |
| **Certificate Authority (CA)**  | The trusted third party that verifies identities and **issues/signs** digital certificates using its own private key.                         |
| **Certificate Database**        | A database maintained by the CA that stores all the certificates it has issued and their current status (e.g., valid, revoked).               |
| **Registration Authority (RA)** | (Optional) A subordinate entity authorized by a root CA to handle specific verification and issuance tasks, offloading work from the main CA. |

---
#### The PKI Workflow

1.  **Issuance:**
    *   Bob proves his identity to the CA.
    *   The CA validates Bob, creates a certificate for him, signs it with the CA's private key, and stores a copy in its database.
    *   The CA issues the signed certificate to Bob.

2.  **Exchange:**
    *   Bob initiates communication with Alice and presents his digital certificate as proof of identity.

3.  **Verification:**
    *   Alice receives Bob's certificate.
    *   Alice's computer uses the public key of the **CA** (which it already trusts from its local certificate store) to verify the CA's signature on Bob's certificate.
    *   Alice's computer may also contact the CA to check the certificate's current status (e.g., to see if it has been revoked).
    *   **Result:** Alice can now trust that Bob's public key is authentic and can proceed with secure communication.


---

# 18.6.3: The PKI Authorities System

**Core Concept:** Trust in the PKI is not uniform. It's based on the level of identity verification performed by the Certificate Authority (CA) and a pre-established "root of trust" in software.

---
#### Levels of Trust (Certificate Classes)
CAs offer different classes of certificates, which correspond to the rigor of the identity verification process.

| Certificate Class | Validation Method | Level of Assurance |
| :--- | :--- | :--- |
| **Class 1** | Weak (e.g., simple email confirmation). | **Low Assurance.** |
| **Class 3 / 4**| Strong (e.g., in-person verification with official IDs). | **High Assurance.** |

---
#### The Root of Trust: How Browsers Trust CAs
*   Operating systems and web browsers come with a pre-installed list of **Trusted Root Certificate Authorities**. This is often called the "certificate store."
*   This pre-loaded list is the foundation of the entire trust model on the internet.
*   Any certificate signed by one of these pre-loaded CAs (or by an intermediate CA that was authorized by a root CA) is **automatically trusted** by the browser without any warnings.

---
#### Internal / Enterprise PKI
*   An organization can act as its **own Certificate Authority** for internal purposes.
*   This is used to issue certificates to internal users, devices, and services (e.g., for employee authentication to the VPN or securing an internal intranet server).
*   In this model, the company's internal root CA certificate must be manually installed and trusted on all company-managed devices.


---

# 18.6.4: PKI Trust Topologies

PKI establishes trust through different architectural models or topologies. The choice of topology depends on the scale and needs of the organization.

| Topology | Description | Pros | Cons |
| :--- | :--- | :--- | :--- |
| **Single-Root** | A single Certificate Authority (CA), the "root CA," issues and manages all certificates for all end-users. | **Simple** to set up and manage. | **Not scalable** for large environments; creates a **single point of failure**. |
| **Cross-Certified** | A peer-to-peer model where independent CAs establish trust relationships by signing each other's certificates. | Provides **redundancy** and eliminates the single point of failure. | Can become complex to manage (a "web of trust"). |
| **Hierarchical** | A tree-like structure with a single Root CA at the top. The Root CA issues certificates to intermediate/subordinate CAs, which in turn can issue certificates to end-users or other CAs below them. | **Highly scalable** and manageable for large organizations (can delegate by department or region). | The chain of trust can be longer and more complex to validate. |

---
*   **Hybrid Topologies:** These models can be combined. For example, two separate hierarchical organizations can cross-certify each other's Root CAs to establish trust between their communities.


---

# 18.6.5: Interoperability of PKI and the X.509 Standard

#### The Core Problem: Interoperability
A major challenge for PKI is **interoperability**. Early on, many vendors created their own proprietary systems instead of waiting for a common standard. This made it difficult for different PKI systems to trust and work with each other.

---
#### The Standard Solution: X.509
To solve this, the IETF standardized the format for digital certificates.
*   **X.509 v3:** The universal standard that defines the **format and contents** of a digital certificate. By adhering to this standard, certificates from any vendor can be understood and validated by any compliant system, ensuring global interoperability.

---
#### Common Applications of X.509 v3 Certificates

| Application / Protocol | How it uses X.509v3 Certificates |
| :--- | :--- |
| **SSL/TLS** | Secure Sockets Layer / Transport Layer Security. Used to authenticate web servers for **HTTPS**. This is the most common use of digital certificates. |
| **IPsec** | Internet Protocol Security. Used in VPNs to authenticate peers during the **Internet Key Exchange (IKE)** phase. |
| **S/MIME** | Secure/Multipurpose Internet Mail Extensions. Used to provide **digital signatures and encryption for email**. |
| **EAP-TLS** | Extensible Authentication Protocol - TLS. Used for certificate-based authentication in **802.1X Network Access Control (NAC)**, securing access to wired and wireless networks. |


---

# 18.6.6: Certificate Enrollment, Authentication, and Revocation

#### 1. Obtaining Trust: The CA's Self-Signed Certificate
*   The entire PKI trust model starts with securely obtaining the public key of the root Certificate Authority (CA).
*   This public key is contained in a special certificate called a **self-signed certificate**.
*   For public CAs, these root certificates are **pre-installed** in operating systems and web browsers, forming the initial "root of trust."

#### 2. Enrollment: Getting Your Own Certificate
*   **Enrollment** is the process a user or system uses to request and receive a digital certificate from a CA.
*   **Out-of-Band (OOB) Authentication:** A crucial step in enrollment is verifying the CA's identity. To prevent man-in-the-middle attacks, this is often done "out-of-band" by confirming a certificate's **fingerprint** (a hash of the certificate) over a separate, trusted channel like a phone call.

#### 3. Authentication: Using the Certificate
*   Once a system has its own certificate and trusts the CA, it can authenticate other entities without needing to contact the CA for every transaction.
*   It simply validates the signature on the other party's certificate using the CA's public key from its local certificate store.

---
#### 4. Revocation: Invalidating a Certificate
When a certificate can no longer be trusted (e.g., its private key was stolen, or the owner left the company), it must be **revoked** before its natural expiration date. There are two primary methods for checking revocation status.

| Method | How it Works | Pros | Cons |
| :--- | :--- | :--- | :--- |
| **CRL** (Certificate Revocation List) | The CA periodically publishes a digitally signed **list** of all revoked certificate serial numbers. Clients must download this entire list and check it. | Simple and well-established. | **Latency:** The list is only updated periodically (e.g., every 24 hours), so there's a window where a compromised certificate might still be accepted. <br> **Size:** The list can become very large and slow to download. |
| **OCSP** (Online Certificate Status Protocol) | A client sends a real-time query to an "OCSP Responder" server asking for the status of a **single certificate**. The server responds with "good," "revoked," or "unknown." | **Real-time:** Provides immediate, up-to-date revocation information. | **Performance/Privacy:** Can increase connection latency and reveals to the CA which websites a user is visiting. |