
***

### **Topic: Authorities and the PKI Trust System**

#### **1. Public Key Management & Digital Certificates**

*   **Digital Certificate:** An electronic document that proves the ownership of a public key. It's like a digital driver's license. It binds an identity (like a website's domain name) to a public key.
*   **Certificate Authority (CA):** A trusted third-party organization that verifies identities and issues digital certificates. Examples include DigiCert, GoDaddy, and the non-profit Let's Encrypt.
*   **Public Key Infrastructure (PKI):** The entire framework of hardware, software, policies, and procedures used to create, manage, distribute, use, store, and revoke digital certificates.

#### **2. The Four Main Elements of PKI**

1.  **PKI Certificate:** Contains the public key, information about the owner, the issuing CA, and validity dates.
2.  **Certificate Store:** A local repository on a computer that stores trusted CA certificates and private keys.
3.  **Certificate Authority (CA):** The trusted entity that issues certificates.
4.  **Certificate Database:** The CA's record of all the certificates it has issued.

#### **3. The PKI Trust Process**

1.  **Issuance:** A user (Bob) requests a certificate from a CA. The CA verifies Bob's identity and issues a certificate.
2.  **Exchange:** Bob wants to communicate securely with Alice, so he sends her his digital certificate.
3.  **Verification:** Alice receives Bob's certificate. To trust it, her system contacts the CA (using the CA's public key, which is already in her browser's trust store) to confirm that the certificate is authentic and has not been revoked.

#### **4. PKI Topologies (How CAs Trust Each Other)**

*   **Single-Root PKI:** One single CA issues all certificates. It's simple but not scalable and has a single point of failure.
*   **Cross-Certified CA:** A peer-to-peer model where different CAs agree to trust each other's certificates. This provides redundancy.
*   **Hierarchical CA:** A root CA issues certificates to subordinate CAs, which in turn issue certificates to end-users. This is a highly scalable and common model for large organizations.

#### **5. Standards and Applications**

*   **X.509v3:** The universal standard format for public key certificates. Its use ensures that certificates from different vendors can work together.
*   **Common Applications:**
    *   **SSL/TLS:** Securing web traffic (HTTPS).
    *   **IPsec:** Securing VPN connections.
    *   **S/MIME:** Securing email communications.
    *   **EAP-TLS (802.1x):** Authenticating devices on a network.

#### **6. Certificate Lifecycle**

*   **Enrollment:** The process of requesting and obtaining a certificate from a CA.
*   **Revocation:** Invalidating a certificate before its expiration date (e.g., if a private key is compromised). Two common methods are:
    *   **CRL (Certificate Revocation List):** A periodically published list of all revoked certificates. Clients must download this list to check a certificate's status.
    *   **OCSP (Online Certificate Status Protocol):** A real-time method where a client sends a request to a CA's server to check the status of a single certificate.

***

### **Lab Summary: Certificate Authority Stores**

#### **Objective:**
To view the certificates trusted by a browser and to use hashing (fingerprints) to detect a potential Man-in-the-Middle (MITM) attack.

#### **Part 1: Viewing Trusted Certificates**
Your web browser comes with a pre-installed list of trusted Root Certificate Authorities. Any certificate signed by one of these root CAs is automatically trusted.
*   **How to view:**
    *   **Firefox:** Preferences > Privacy & Security > View Certificates.
    *   **Chrome:** Settings > Privacy and security > Manage certificates.

#### **Part 2: Detecting a Man-in-the-Middle (MITM) Attack**

*   **Concept:** An organization can intercept its employees' encrypted HTTPS traffic by installing its own custom CA certificate into the browser's trust store. This allows a proxy server to impersonate any website, decrypt the traffic for inspection, and then re-encrypt it to the real destination.
*   **Detection Method:** Compare the **certificate fingerprint** (a unique hash of the certificate) of the site you are connected to with the known, legitimate fingerprint of that site. If they do not match, your connection is being intercepted.
*   **Key Commands (using `openssl`):**
    1.  **Fetch the certificate from a website:**
        ```bash
        echo -n | openssl s_client -connect cisco.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > ./cisco.com.pem
        ```
    2.  **Calculate the certificate's fingerprint (SHA-1 hash):**
        ```bash
        openssl x509 -noout -in cisco.com.pem -fingerprint -sha1
        ```

*   **Conclusion:** If the fingerprint calculated from your connection matches the known, true fingerprint for the site, your connection is direct and secure. If they differ, it indicates a probable MITM interception.