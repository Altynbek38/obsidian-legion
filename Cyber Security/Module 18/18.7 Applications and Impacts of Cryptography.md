
---

# 18.7.1: Common PKI Applications in the Enterprise

Public Key Infrastructure (PKI) is the foundational technology that enables a wide range of security services. Here are its most common uses:

*   **Securing Web Traffic:**
    *   **HTTPS:** Authenticating web servers and encrypting web traffic using SSL/TLS certificates.

*   **Securing Network Communications:**
    *   **IPsec VPNs:** Authenticating VPN peers (routers/firewalls) and users.
    *   **SSL/TLS VPNs:** Authenticating remote access users.

*   **Network Access Control (NAC):**
    *   **802.1X:** Authenticating devices and users before granting them access to the wired or wireless network (often using EAP-TLS).

*   **Securing Communications:**
    *   **Secure Email (S/MIME):** Digitally signing and encrypting emails.
    *   **Secure Instant Messaging:** Authenticating users and encrypting chat sessions.

*   **Software and Data Integrity:**
    *   **Code Signing:** Verifying the authenticity and integrity of applications and software updates.
    *   **Encrypting File System (EFS):** Protecting user data on Windows file systems.
    *   **Securing USB Storage:** Encrypting data on removable storage devices.

*   **Strong Authentication:**
    *   **Two-Factor Authentication (2FA):** Implementing certificate-based authentication with smart cards.


---

# 18.7.2: Challenges of Encrypted Network Transactions

#### The Security "Blind Spot" of Encryption
While essential for confidentiality, widespread SSL/TLS encryption creates a major security challenge: security appliances (like firewalls and IPS) **cannot inspect the content of encrypted traffic**.

*   **The Risk:** Attackers can exploit this blind spot to hide their activities within a legitimate-looking encrypted tunnel.
*   **Threats hidden by SSL/TLS:**
    *   Malware and viruses.
    *   Data loss (exfiltration of sensitive data).
    *   Intrusion attempts.
    *   Regulatory compliance violations.

---
#### Common Certificate Validation Errors
Web browsers will display security warnings when they encounter issues with a website's PKI certificate. Two common causes are:

| Error Type | Cause / Meaning |
| :--- | :--- |
| **Invalid Validity Date** | The current date is outside the "Valid from" and "Valid to" dates specified in the certificate. This could be a simple administrative oversight or a sign of a more serious issue. |
| **Signature Validation Error**| The browser cannot verify the digital signature on the certificate. This usually means the browser does not trust the Certificate Authority (CA) that issued it (the CA's root certificate is not in the browser's trusted store). |

---
#### Cipher Suites: The Solution for Evolving Security
*   **What is a Cipher Suite?** A "bundle" of cryptographic algorithms that a client and server agree to use for a secure SSL/TLS session. It defines a specific combination of:
    1.  **Key Exchange Algorithm** (e.g., Diffie-Hellman, RSA)
    2.  **Authentication Algorithm** (e.g., RSA, ECDSA)
    3.  **Bulk Encryption Algorithm** (e.g., AES)
    4.  **Message Authentication Code (MAC) Algorithm** (e.g., HMAC-SHA256)

*   **Why are they important?**
    *   **Modularity:** They allow the security of SSL/TLS to evolve. When a vulnerability is discovered in one algorithm (e.g., RC4), administrators can simply disable cipher suites that use it and enable ones with stronger alternatives (like AES) **without having to replace the entire SSL/TLS protocol**.


---

# 18.7.3: Encryption and Security Monitoring

#### The Core Challenge: The Encryption Blind Spot
Encryption is essential for confidentiality, but it creates a **security blind spot** by preventing monitoring tools (like firewalls and Intrusion Prevention Systems - IPS) from inspecting traffic content for threats.

---
#### Solutions for Monitoring Encrypted Traffic

*   **Strategic Placement (for VPNs):**
    *   Position the IPS **inside** the VPN tunnel (on the LAN side of the VPN endpoint). This allows it to inspect traffic *after* it has been decrypted.

*   **SSL/TLS Decryption (for HTTPS):**
    *   Deploy a dedicated **SSL Decryption Appliance**. This device performs a legitimate "man-in-the-middle" action: it decrypts incoming traffic, sends the cleartext to an IPS for inspection, and then re-encrypts it before forwarding it to the final destination.

*   **Other Supporting Controls:**
    *   Implement **URL filtering** to block access to known malicious sites, even if they use HTTPS.
    *   Enforce strict **server certificate validation** (using CRLs/OCSP) to detect fraudulent certificates.

---
#### Impact of Cryptography on Security Investigations
Cryptography affects security investigations in two primary ways:

| Impact Type | Description / Risk |
| :--- | :--- |
| **Attacks *on* Cryptography** | If an attacker breaks an encryption algorithm or steals a key, they can decrypt previously captured encrypted data, leading to a massive data breach. |
| **Attacks *using* Cryptography**| Attackers hide their malicious activity inside encrypted channels. For example, **Command and Control (C2) traffic** hidden inside a TLS tunnel is invisible to a firewall and can be used to control infected hosts and build botnets. |

#### Detecting Malicious Encrypted Traffic
Finding hidden threats like encrypted C2 traffic is difficult but can be done through two main approaches:
1.  **Active Decryption:** Using an SSL appliance to decrypt the traffic and inspect it for known attack signatures. (Resource-intensive).
2.  **Anomaly Detection:** Analyzing traffic metadata (without decrypting it) to identify suspicious patterns, such as unusual connection times, data volumes, or destinations. (Challenging and can be a "hit-or-miss" process).